<div *ngIf="data" [hidden]="!data.visible" class="pnd-modal pnd-notebook-share-modal">
    <div class="pnd-modal__overlay" (click)="onClose($event.target)">
        <div class="pnd-modal__window">
            <div class="pnd-modal__close">
                <pnd-svg-icon [data]="{ id: 'times' }" (click)="onClose()"></pnd-svg-icon>
            </div>
            
            <div class="pnd-modal__header">
                <div class="pnd-modal__header-text">
                    {{ data.header.label }}
                </div>
            </div>
            
            <div class="pnd-modal__body">
                <ng-container *ngIf="!data.body.confirmSection">
                    <!-- FORM SECTION -->
                    <div *ngIf="data.body.formSection as form" 
                    class="pnd-notebook-share-modal__section pnd-notebook-share-modal__section-confirm">
                        <div class="pnd-modal__body-text">
                            {{ form.text }}
                        </div>
                        <div *ngIf="form.autocomplete as autocomplete" class="pnd-notebook-share-modal__autocomplete">
                            <div class="pnd-notebook-share-modal__input">
                                <input type="text"
                                    name="notebook-autocomplete"
                                    class="small"
                                    [placeholder]="autocomplete.input.placeholder"
                                    (input)="onInput($event.target.value)">
                            </div>
                            <div class="pnd-notebook-share-modal__results-wrapper">
                                <div *ngIf="autocomplete.results?.length" class="pnd-notebook-share-modal__results">
                                    <div *ngFor="let item of autocomplete.results" 
                                    (click)="onAutocompleteClick(item)"
                                    class="pnd-notebook-share-modal__item">
                                        <div *ngIf="item.thumb" class="pnd-notebook-share-modal__item-thumb">
                                            <img [src]="(imageDataService.images[item.thumb]?.data | async) || item.thumb"
                                                onerror="this.style.display='none'">
                                        </div>
                                        <div class="pnd-notebook-share-modal__item-content">
                                            <div class="pnd-notebook-share-modal__item-label">{{ item.username }}</div>
                                            <div [hidden]="item.hideEmail" class="pnd-notebook-share-modal__item-email">{{ item.email }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end/FORM SECTION -->

                    <!-- LIST SECTION -->
                    <div *ngIf="data.body.listSection as list" 
                    class="pnd-notebook-share-modal__section pnd-notebook-share-modal__list">
                        <div class="pnd-modal__body-title">
                            {{ list.title }}
                        </div>
                        <div class="pnd-modal__body-list">
                            <div *ngFor="let item of list.items" class="pnd-notebook-share-modal__list-item">
                                <div class="pnd-notebook-share-modal__list-item-thumb">
                                    <img [src]="(imageDataService.images[item.thumb]?.data | async) || item.thumb"
                                        onerror="this.style.display='none'">
                                </div>
                                <div class="pnd-notebook-share-modal__list-item-label">{{ item.username }}</div>
                                <!-- OWNER -->
                                <div *ngIf="item.role === 'owner'" class="pnd-notebook-share-modal__list-item-role">
                                    {{ item.roleAsLabel }}
                                </div>
                                <!-- DROPDOWN -->
                                <div *ngIf="item.role !== 'owner'" class="pnd-notebook-share-modal__list-item-dropdown">
                                    <div *ngIf="item.dropdown as dropdown" class="pnd-dropdown {{ dropdown.isExpanded ? 'is-expanded' : '' }}">

                                        <!-- Selected element -->
                                        <button class="pnd-dropdown__selected"
                                            (click)="dropdownToggle(item)">
                                            <div class="pnd-dropdown__selected-label" title="{{item.statusAsLabel}}">
                                                {{ item.statusAsLabel }}
                                            </div>
                                            <div class="pnd-dropdown__selected-right-icon">
                                                <pnd-svg-icon *ngIf="!dropdown.isExpanded" [data]="{ id: 'angle-down' }"></pnd-svg-icon>
                                                <pnd-svg-icon *ngIf="dropdown.isExpanded" [data]="{ id: 'angle-up' }"></pnd-svg-icon>
                                            </div>
                                        </button>
                                        <!-- END // Selected element -->
                                
                                        <!-- Dropdown items -->
                                        <div class="pnd-dropdown__list-wrapper">
                                            <!-- list of actions -->
                                            <div class="pnd-dropdown__list-items">
                                                <ng-container *ngFor="let action of dropdown.actions">
                                                    <div (click)="onActionClick(action.payload)" class="pnd-dropdown__item">
                                                        {{ action.label }}
                                                    </div>
                                                </ng-container>
                                            </div>
                                        </div>
                                        <!-- END // Dropdown items -->
                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end/LIST SECTION -->
                </ng-container>

                <!-- CONFIRM SECTION -->
                <ng-container *ngIf="data.body.confirmSection as confirm">
                    <div class="pnd-notebook-share-modal__section pnd-notebook-share-modal__section-confirm">
                        <div class="pnd-modal__body-text">
                            {{ confirm.text }}
                        </div>
                    </div>
                </ng-container>
                <!-- end/CONFIRM SECTION -->
            </div>
            
            <div class="pnd-modal__actions">
                <a *ngFor="let action of data.actions" class="pnd-btn {{ action.classes || '' }}" 
                (click)="onClick($event, action.payload)">
                    {{ action.label }}
                </a>
            </div>

        </div>
    </div>
</div>
